
(function(a){a.fn.idleTimeout=function(b){var m=this;var s={redirectUrl:"/logout",idleTimeLimit:1200,idleCheckHeartbeat:2,customCallback:false,activityEvents:"click keypress scroll wheel mousewheel mousemove",enableDialog:true,dialogDisplayLimit:180,dialogTitle:"Session Expiration Warning",modifyPageTitle:true,dialogText:"Because you have been inactive, your session is about to expire.",dialogTimeRemaining:"Time remaining",dialogStayLoggedInButton:"Stay Logged In",dialogLogOutNowButton:"Log Out Now",errorAlertMessage:'Please disable "Private Mode", or upgrade to a modern browser. Or perhaps a dependent file missing. Please see: https://github.com/marcuswestin/store.js',sessionKeepAliveTimer:600,sessionKeepAliveUrl:window.location.href,useCustomPopup:false,onPopupRequired:function(){},onDialogTimerTicked:function(G,F){},onDialogShouldBeHided:function(){}},q=a.extend(s,b),B=document.title,i,v,A,f,r,h,u,g,e,w,D,d,l,C,y,o,p,k,x,E,t,c,j,z,n;this.logout=function(){store.set("idleTimerLoggedOut",true)};this.iframeRecheck=function(){j()};this.stayLogged=function(){t=false;x();p();D()};this.logoutUser=function(){c()};i=function(){store.set("activityEvents",q.activityEvents)};A=function(){r=function(){a.get(q.sessionKeepAliveUrl);A()};h=setTimeout(r,(q.sessionKeepAliveTimer*1000))};f=function(){clearTimeout(h)};v=function(){a("body").on(q.activityEvents,function(){if((store.get("idleTimerLoggedOut")!==true)&&(!q.enableDialog||k()!==true)){D()}})};e=function(){var F=(store.get("idleTimerLastActivity")+(q.idleTimeLimit*1000));if(a.now()>F){if(!q.enableDialog){c()}else{if(q.enableDialog&&k()!==true){l();o()}}}else{if(store.get("idleTimerLoggedOut")===true){c()}else{if(q.enableDialog&&k()===true){x();p()}}}};D=function(){d();store.set("idleTimerLastActivity",a.now());w()};w=function(){e();u=setTimeout(w,(q.idleCheckHeartbeat*1000))};d=function(){clearTimeout(u)};l=function(){t=true;s.onPopupRequired();if(!s.useCustomPopup){var F="<div id='idletimer_warning_dialog'><p>"+q.dialogText+"</p><p style='display:inline'>"+q.dialogTimeRemaining+": <div style='display:inline' id='countdownDisplay'></div></p></div>";a(F).dialog({buttons:[{text:q.dialogStayLoggedInButton,click:function(){m.stayLogged()}},{text:q.dialogLogOutNowButton,click:function(){m.logoutUser()}}],closeOnEscape:false,modal:true,title:q.dialogTitle,open:function(){a(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}})}E();if(q.modifyPageTitle){document.title=q.dialogTitle}if(q.sessionKeepAliveTimer){f()}};y=function(){var F=(store.get("idleTimerLastActivity")+(q.idleTimeLimit*1000)+(q.dialogDisplayLimit*1000));if((a.now()>F)||(store.get("idleTimerLoggedOut")===true)){c()}};o=function(){C=setInterval(y,(q.idleCheckHeartbeat*1000))};p=function(){clearInterval(C);clearInterval(g)};k=function(){return t};x=function(){q.onDialogShouldBeHided();if(!q.useCustomPopup){a("#idletimer_warning_dialog").dialog("destroy").remove()}if(q.modifyPageTitle){document.title=B}if(q.sessionKeepAliveTimer){A()}};E=function(){var H=q.dialogDisplayLimit,G,F;g=setInterval(function(){G=Math.floor(H/60);if(G<10){G="0"+G}F=H-(G*60);if(F<10){F="0"+F}q.onDialogTimerTicked(G,F);if(q.useCustomPopup){a("#countdownDisplay").html(G+":"+F)}H-=1},1000)};c=function(){store.set("idleTimerLoggedOut",true);if(q.sessionKeepAliveTimer){f()}if(q.customCallback){q.customCallback()}if(q.redirectUrl){window.location.href=q.redirectUrl}};a("body").on("dialogopen",function(){if(q.enableDialog&&k()!==true){j()}});j=function(){var G,F;G=function(){if(document.readyState==="complete"){clearInterval(F);z()}};F=setInterval(G,1000)};z=function(G){if(!G){G=a(document)}var F=0;G.find("iframe,frame").each(function(){if(a(this).hasClass("jit-inspected")===false){try{z(a(this).contents());a(this).on("load",n(a(this)));var I=a(this)[F];if(I.attachEvent){I.attachEvent("onload",n(a(this)))}F++}catch(H){a(this).addClass("jit-inspected cross-site")}}})};n=function(G){var H=G.contents(),F=store.get("activityEvents");try{H.on(F,function(J){a("body").trigger(J)});G.addClass("jit-inspected")}catch(I){}};return this.each(function(){if(store.enabled){store.set("idleTimerLastActivity",a.now());store.set("idleTimerLoggedOut",false);i();v();if(q.sessionKeepAliveTimer){A()}D();j()}else{alert(q.errorAlertMessage)}})}}(jQuery));